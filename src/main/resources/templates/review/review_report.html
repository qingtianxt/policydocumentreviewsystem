<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>H+ 后台主题UI框架 - 客户管理</title>
    <meta name="keywords" content="H+后台主题,后台bootstrap框架,会员中心主题,后台HTML,响应式后台">
    <meta name="description" content="H+是一个完全响应式，基于Bootstrap3最新版本开发的扁平化主题，她采用了主流的左右两栏式布局，使用了Html5+CSS3等现代技术">

    <link rel="shortcut icon" href="favicon.ico">

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">

    <link href="../css/animate.min.css" rel="stylesheet">
    <link href="../css/style.min.css" rel="stylesheet">
    <link href="../css/plugins/checkweight/bootstrap.css" rel="stylesheet"/>
    <link href="../css/plugins/checkweight/style.css" rel="stylesheet"/>
    <link href="../css/plugins/checkweight/global.css" rel="stylesheet"/>
    <link href="../css/plugins/checkweight/reset.css" rel="stylesheet"/>
    <link href="../css/plugins/toastr/toastr.min.css" rel="stylesheet">
    <style type="text/css">
        .content-tips .paper-section {
            margin-bottom: 0;
            min-width: 450px;
        }

        .text-green {
            color: #56b282;
        }

        .text-red {
            color: #f12828;
        }

        .text-orange {
            color: #f39800;
        }
    </style>

</head>

<body class="gray-bg">
<div class="wrapper wrapper-content  animated fadeInRight">
    <div class="gohome">
        <a class="animated bounceInUp" href="javascript:history.back(-1)" title=返回列表><i class="fa fa-history"></i></a>
    </div>
    <div class="row">
        <div class="ibox">
            <div class="ibox-title">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="m-b-md">
                            <!-- <a href="#" class="btn btn-white btn-xs pull-right">编辑项目</a>-->
                            <h2 th:text="${policy_review.reviewName}">01河北省地方税务局关于企业所得税若干业务问题的公告</h2>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-8">
                        <dl class="dl-horizontal">

                            <dt>政策作者:</dt>
                            <dd>张三</dd>
                            <dt>提交时间:</dt>
                            <dd th:text="${#dates.format(policy_review.uploadDate,'yyyy-MM-dd')}">2018-10-28 21:49:36
                            <dt>所在单位:</dt>
                            <dd>河北省地方税务局</dd>
                            </dd>
                        </dl>
                    </div>
                    <div class="col-sm-2" id="cluster_info">
                        <dl class="dl-horizontal">

                            <dt>政策字数:</dt>
                            <dd>1752</dd>
                            <dt>段落个数:</dt>
                            <dd th:text="${#lists.size(contentList)}">64</dd>
                            <dt>句子个数:</dt>
                            <dd th:text="${#lists.size(list)}">86</dd>

                        </dl>
                    </div>
                    <div class="col-sm-2" id="cluster_info">
                        <dl class="dl-horizontal">

                            <dt>总体合法性</dt>
                            <!--<dd>70%</dd>-->
                            <dt>70%</dt>
                            <dt>
                                <div class="progress progress-striped active m-b-sm">
                                    <div style="width: 70%;" class="progress-bar"></div>
                                </div>
                            </dt>

                        </dl>
                    </div>
                </div>
            </div>
            <div class="ibox-content  panel blank-panel">
                <div class="clients-list">
                    <ul class="nav nav-tabs page-tabs J_menuTabs">
                        <li class="active">
                            <a data-toggle="tab" href="#tab-1" class="J_menuTab active"><i class="fa  fa-archive"></i>
                                详细报告</a>
                        </li>
                        <li class="">
                            <a data-toggle="tab" href="#tab-2" class="J_menuTab active"><i class="fa  fa-archive "></i>
                                综合评估</a>
                        </li>
                        <li class="">
                            <a data-toggle="tab" href="#tab-3" class="J_menuTab active"><i class="fa  fa-archive "></i>
                                修改文档</a>
                        </li>
                        <li class="">
                            <a data-toggle="tab" href="#tab-4" class="J_menuTab active"><i class="fa  fa-archive "></i>
                                查看原文</a>
                        </li>
                        <li class="">
                            <a data-toggle="tab" href="#tab-5" class="J_menuTab active"><i class="fa  fa-archive "></i>
                                打印PDF</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <!--
                            作者：2628556573@qq.com
                            时间：2018-10-31
                            描述：句子报告
                        -->
                        <div id="tab-1" class="tab-pane active">
                            <div class="wrapper wrapper-content">
                                <div class="row animated fadeInRight">
                                    <div class="col-sm-7">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-title">
                                                <h5>文档内容</h5>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="text-center PT30">
                                                </div>
                                                <div class="paper-txt P30 PB0"
                                                     th:each="policy_review_analysis:${list}">


                                                    <div class="paper-section" tpl-section="warp"
                                                         th:if="${policy_review_analysis.similarityDegree>90}">
                                                        <span class="label-warning" tpl-section="badge"
                                                              th:id="${policy_review_analysisStat.index+1}"
                                                              th:text="${policy_review_analysisStat.index+1}">1</span>

                                                        <p class="MT20 text-idt25" tpl-section="text">
                                                            <a href="javascript:void(0)"
                                                               th:onclick="'javascript:getByAnalysis('+${policy_review_analysis.analysisId}+',\''+${policy_review_analysis.analysisName}+'\',\''+${policy_review_analysis.similarityDegree}+'\');'"
                                                               class="g-font-color red"
                                                               th:text="${policy_review_analysis.analysisName}">
                                                            </a>
                                                        </p>
                                                        <div class="text-right">
                                                            <button type="button" tpl-section="btn"
                                                                    class="g-btn g-btn-default g-btn-sm MT10">段落修改
                                                            </button>
                                                        </div>
                                                        <div tpl-section="box"></div>
                                                    </div>
                                                    <div class="paper-section" tpl-section="warp"
                                                         th:if="${policy_review_analysis.similarityDegree>70&&policy_review_analysis.similarityDegree<=90}">
                                                        <span class="label-warning" tpl-section="badge"
                                                              th:id="${policy_review_analysisStat.index+1}"
                                                              th:text="${policy_review_analysisStat.index+1}">1</span>

                                                        <p class="MT20 text-idt25" tpl-section="text">
                                                            <a href="javascript:void(0)"
                                                               th:onclick="'javascript:getByAnalysis('+${policy_review_analysis.analysisId}+',\''+${policy_review_analysis.analysisName}+'\',\''+${policy_review_analysis.similarityDegree}+'\');'"
                                                               class="g-font-color green"
                                                               th:text="${policy_review_analysis.analysisName}">
                                                            </a>
                                                        </p>
                                                        <div class="text-right">
                                                            <button type="button" tpl-section="btn"
                                                                    class="g-btn g-btn-default g-btn-sm MT10">段落修改
                                                            </button>
                                                        </div>
                                                        <div tpl-section="box"></div>
                                                    </div>
                                                    <div class="paper-section" tpl-section="warp"
                                                         th:if="${policy_review_analysis.similarityDegree>40&&policy_review_analysis.similarityDegree<=70}">
                                                        <span class="label-warning" tpl-section="badge"
                                                              th:id="${policy_review_analysisStat.index+1}"
                                                              th:text="${policy_review_analysisStat.index+1}">1</span>

                                                        <p class="MT20 text-idt25" tpl-section="text">
                                                            <a href="javascript:void(0)"
                                                               th:onclick="'javascript:getByAnalysis('+${policy_review_analysis.analysisId}+',\''+${policy_review_analysis.analysisName}+'\',\''+${policy_review_analysis.similarityDegree}+'\');'"
                                                               class="g-font-color orange"
                                                               th:text="${policy_review_analysis.analysisName}">
                                                            </a>
                                                        </p>
                                                        <div class="text-right">
                                                            <button type="button" tpl-section="btn"
                                                                    class="g-btn g-btn-default g-btn-sm MT10">段落修改
                                                            </button>
                                                        </div>
                                                        <div tpl-section="box"></div>
                                                    </div>
                                                    <div class="paper-section" tpl-section="warp"
                                                         th:if="${policy_review_analysis.similarityDegree<=40}">
                                                        <span class="label-warning" tpl-section="badge"
                                                              th:id="${policy_review_analysisStat.index+1}"
                                                              th:text="${policy_review_analysisStat.index+1}">1</span>

                                                        <p class="MT20 text-idt25" tpl-section="text">
                                                            <a href="javascript:void(0)"
                                                               th:onclick="'javascript:getByAnalysis('+${policy_review_analysis.analysisId}+',\''+${policy_review_analysis.analysisName}+'\',\''+${policy_review_analysis.similarityDegree}+'\');'"
                                                               class="g-font-color orange"
                                                               th:text="${policy_review_analysis.analysisName}"></a>
                                                        </p>
                                                        <div class="text-right">
                                                            <button type="button" tpl-section="btn"
                                                                    class="g-btn g-btn-default g-btn-sm MT10">段落修改
                                                            </button>
                                                        </div>
                                                        <div tpl-section="box"></div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-title">
                                                <h5>合法性详情</h5>
                                            </div>
                                            <div class="ibox-content" id="getByAnalysisId">
                                                <div class="paper-txt P30 paper-section">
                                                    <h4 class="MB10 font-bold">句子的不同颜色代表不同的合法性</h4>
                                                    <ul class="unstyled">
                                                        <li>
                                                            <span class="notice-diamond red"></span>
                                                            <span class="text-red MR5">红色</span> 代表合法性在40%以下（重度违法，请全面修改）
                                                        </li>
                                                        <li>
                                                            <span class="notice-diamond orange"></span>
                                                            <span class="g-font-color orange MR5">橙色</span>
                                                            代表合法性在40%-70%（轻度违法，请酌情修改）
                                                        </li>
                                                        <li>
                                                            <span class="notice-diamond green"></span>
                                                            <span class="text-green MR5">绿色</span> 代表合格
                                                        </li>
                                                    </ul>
                                                    <p class="MT15">
                                                        如果要查看句子详细检测结果<br> 请点击报告中红色、橙色标记的部分
                                                    </p>
                                                    <p class="MT20 font-bold">
                                                        本系统包含<span class="text-green">段落修改功能，可以边看边对段落进行修改。</span>
                                                        <br> 临时保存的段落可以在上方“修改文档”里看到，
                                                        <br> 修改过的段落会变成绿色。
                                                        <br>
                                                        <span class="red">本功能受系统环境影响，请尽快将修改后的政策保存在word文档中</span>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>


                        <!--
                            作者：2628556573@qq.com
                            时间：2018-10-31
                            描述：综合评估
                            -->
                        <div id="tab-2" class="tab-pane">
                            <div class="wrapper wrapper-content">
                                <div class="row">
                                    <div class="col-sm-5">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-title">
                                                <h5>基本信息</h5>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="basic-info">
                                                    <div class="assessment-area paper-txt info MB15">
                                                        <ul class="papersource-list-group unstyled">
                                                            <li><span>政策名称:</span><span
                                                                    th:text="${policy_review.reviewName}">测试查重文档</span>
                                                            </li>
                                                            <li><span>上传人员:</span><span>张三</span></li>
                                                            <li><span>审查时间:</span><span
                                                                    th:text="${#dates.format(policy_review.uploadDate,'yyyy-MM-dd')}">2018-10-28 21:49:36</span>
                                                            </li>
                                                            <li><span>文档字数:</span>1752</li>
                                                            <li><span>段落个数:</span><span
                                                                    th:text="${#lists.size(contentList)}"></span>
                                                            </li>
                                                            <li><span>句子个数:</span><span
                                                                    th:text="${#lists.size(list)}"></span></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-title">
                                                <h5>相似度信息</h5>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="assessment-area similar paper-txt">
                                                    <div class="similar-progress-group">
                                                        <span class="similar-type">总体相似度</span>
                                                        <span class="progress grey MLR10">
	                           <span class="progress-bar red" style="width: 77%;"></span>
																</span>
                                                        <span class="g-font-color red percentage-span">77%</span>
                                                    </div>
                                                    <div class="similar-progress-group">
                                                        <span class="similar-type">对比库：</span>
                                                        <span class="progress grey MLR10">
	                           <span class="progress-bar orange" style="width: 67%;"></span>
																</span>
                                                        <span class="g-font-color orange percentage-span">67%</span>
                                                    </div>
                                                    <div class="similar-progress-group">
                                                        <span class="similar-type">审查文件库：</span>
                                                        <span class="progress grey MLR10">
	                           <span class="progress-bar orange" style="width: 59%;"></span>
																</span>
                                                        <span class="g-font-color orange percentage-span">59%</span>
                                                    </div>

                                                    <div class="similar-progress-group">
                                                        <span class="similar-type">互联网：</span>
                                                        <span class="progress grey MLR10">
	                           <span class="progress-bar orange" style="width:68%;"></span>
																</span>
                                                        <span class="g-font-color orange percentage-span">68%</span>
                                                    </div>

                                                    <p class="font-bold g-font-s16 g-font-color green PT30">相似度计算公式</p>
                                                    <p class="font-bold">（句子1相似度+句子2相似度+...+句子n相似度）/ n</p>
                                                    <span class="MR10">句子相似度范围0.0~1.0 </span> <span>绿色句子相似度按照0计算</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="ibox float-e-margins">
                                            <div class="ibox-title">
                                                <h5>审查库范围</h5>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="assessment-area library-range paper-txt">
                                                    <h4>对比库范围</h4>
                                                    <ul class="circle PL20">
                                                        <li>
                                                            对比库
                                                            <p>
                                                                <span class="g-font-s12 g-font-color grey">1990-2017</span>
                                                            </p>
                                                        </li>
                                                        <li>
                                                            已审查文件
                                                            <p>
                                                                <span class="g-font-s12 g-font-color grey">硕博库1990-2017</span>
                                                            </p>
                                                        </li>
                                                        <li>
                                                            互联网资源
                                                        </li>

                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="ibox float-e-margins">
                                        <div class="ibox-title">
                                            <h5>审查依据</h5>
                                        </div>
                                        <div class="ibox-content">
                                            <ul class="source-list decimal PL20" id="getPolicySimilarity">
                                                <li eve-toggle="warp">
                                                    <span class="g-font-color green percentage-span">23%</span>
                                                    <span class="progress grey MLR10">
	                     <span class="progress-bar green" style="width: 23%;"></span>
															</span>
                                                    <div class="g-arrow inline-block hand MR20" eve-toggle="btn">
                                                        <span class="g-font-color green" eve-toggle="text">详情</span>
                                                        <i class="g-arrow-i"></i>
                                                    </div>
                                                    <span class="MR5">
	                 	 <span class="font-bold paperSource">来源：</span> 书籍数据 西安电子科技大学出版社 2011-12-01
															</span>
                                                    <span class="MR5">
	                 	 <span class="font-bold paperAuthor">作者：</span> 陈卫卫
															</span>
                                                    <span class="MR5">
	                 	 <span class="font-bold paperTitle">篇名：</span> 《软件测试》
															</span>
                                                    <div class="local-source-detail none" eve-toggle="section">
                                                        <div><b>章节：</b>《5.4.2 逻辑覆盖测试》<br><b>书名：</b>《软件测试》<br><b>作者：</b>陈卫卫<br><b>出版社：</b>西安电子科技大学出版社<br><b>出版时间：</b>2011-12-01<br><b>ISBN：</b>978-7-5606-2689-5<br><b>摘要：</b>本书全面系统地介绍了软件测试相关的基本概念、基础理论、应用技术等，按当今国内比较流行的项目驱动、案例教学的思路编写，共设计了九个测试项目。
                                                        </div>
                                                        <div class="g-arrow inline-block hand" eve-toggle-btn="close">

                                                            <span class="g-font-color green">收起</span>
                                                            <i class="g-arrow-i"></i>
                                                        </div>
                                                    </div>
                                                </li>

                                                <li eve-toggle="warp">
                                                    <span class="g-font-color green percentage-span">15%</span>
                                                    <span class="progress grey MLR10">
	                     <span class="progress-bar green" style="width: 15%;"></span>
															</span>
                                                    <div class="g-arrow inline-block hand MR20" eve-toggle="btn">
                                                        <span class="g-font-color green" eve-toggle="text">详情</span>
                                                        <i class="g-arrow-i"></i>
                                                    </div>
                                                    <span class="MR5">
	                 	 <span class="font-bold paperSource">来源：</span> 学位论文 华中科技大学 2008
															</span>
                                                    <span class="MR5">
	                 	 <span class="font-bold paperAuthor">作者：</span> 张鹏
															</span>
                                                    <span class="MR5">
	                 	 <span class="font-bold paperTitle">篇名：</span> 《面向对象软件测试方法及其应用研究》
															</span>
                                                    <div class="local-source-detail none" eve-toggle="section">
                                                        <div>
                                                            <b>篇名：</b>《面向对象软件测试方法及其应用研究》<br><b>作者：</b>张鹏<br><b>学科专业：</b>软件工程<br><b>授予学位：</b>硕士<br><b>导师姓名：</b>肖来元<br><b>学位授予单位：</b>华中科技大学<br><b>学位年度：</b>2008<br><b>关键词：</b>面向对象
                                                            软件测试 类测试 集成测试
                                                        </div>
                                                        <div class="g-arrow inline-block hand" eve-toggle-btn="close">

                                                            <span class="g-font-color green">收起</span>
                                                            <i class="g-arrow-i"></i>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--报告内容修改-->
                        <div id="tab-3" class="tab-pane">
                            <div class="bg-grey PLR40">

                                <div class="paper-txt P30 PB0">
                                    <div class="alert alert-success" role="alert">此为您在“详细报告”中修改后临时保存的内容，编辑过的内容会变绿色</div>

                                    <div th:each="policy_review_analysis:${list}">
                                        <p class="text-idt25" th:id="${policy_review_analysisStat.index+1}+'-data'"
                                           th:text="${policy_review_analysis.analysisName}">动态测试：</p>
                                    </div>
                                    <div class="paper-footer">
                                        <p>检测报告由
                                            <a href="#" target="_black">PRAS</a>规范性文件审查系统生成
                                        </p>
                                        <p>Copyright © 2018-2019 PRAS</p>
                                    </div>
                                </div>

                            </div>


                        </div>
                        <div id="tab-4" class="tab-pane">
                            <div class="bg-grey PLR40">

                                <div class="paper-txt P30 PB0">
                                    <!-- <div class="alert alert-success" role="alert">此为您在“详细报告”中修改后临时保存的内容，编辑过的内容会变绿色</div>-->

                                    <div th:each="policy_review_analysis:${list}">
                                        <p class="text-idt25" th:id="${policy_review_analysisStat.index+1}"
                                           th:text="${policy_review_analysis.analysisName}">动态测试：</p>
                                    </div>
                                    <div class="paper-footer">
                                        <p>检测报告由
                                            <a href="#" target="_black">PRAS</a>规范性文件审查系统生成
                                        </p>
                                        <p>Copyright © 2018-2019 PRAS</p>
                                    </div>时
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</div>
</div>
<script src="../js/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<script src="../js/content.min.js"></script>
<script type="text/javascript" src="../js/Lib.js"></script>
<script src="../js/plugins/toastr/toastr.min.js"></script>

<!--浏览器审查，判断能否使用js效果-->
<script type="text/javascript">
    (function (System, $) {
        'use strict';
        var tab = System.Paper.tab();
        var run = System.Paper.setMainIframeHeight();
        $(function () {
            try {
                if ("undefined" === typeof localStorage || "undefined" === typeof JSON) {
                    $('body').append('<div class="alert-warning"><p>您当前的浏览器不支持段落修改功能，如需使用此功能请<b>更换其它浏览器</b>！</p></div>');
                }
            } catch (e) {
                $('body').append('<div class="alert-warning"><p>您当前的浏览器不支持段落修改功能，如需使用此功能请<b>更换其它浏览器</b>！</p></div>');
            }
            $(document).on('click', '[tab-a="ul"] li', function () {
                tab.call(this);
            });
            $(window).resize(function () {
                run();
            }).trigger('resize');
        });
    })(Report, jQuery);
</script>
<script>
    $(function () {
        $(".full-height-scroll").slimScroll({
            height: "100%"
        })
    });
</script>
<!--句子分析的段落保存样式-->
<script type="text/html" template="section">
    <div class="text-right">
        <div class="modifyTxt-notice">
            修改完本段落之后，点击“临时保存”，之后可在上方导航“修改文档”页面中查看修改后的内容
        </div>
        <textarea class="form-control resize-none" rows="4" tpl-section="textarea"></textarea>
        <div class="button-wrap MT10">
            <button type="button" class="btn btn-warning g-btn-sm btn-rounded" tpl-section-cancle="btn">取消保存
            </button>
            <button type="button" class="btn btn-primary g-btn-sm btn-rounded" tpl-section-save="btn">临时保存</button>
        </div>
    </div>
</script>
<!--句子分析模块 控件事件绑定-->
<script type="text/javascript">
    (function (System, $) {

        var sectionEdit = System.Paper.sectionEdit();
        var sectionSave = System.Paper.sectionSave(null);
        $(function () {
            $(document).on('click', '[tpl-section=btn]', function () {
                // sectionEdit.call(this);
                var $this = $(this);
                var $warp = $this.closest('[tpl-section="warp"]');
                var $box = $warp.find('[tpl-section="box"]');
                $box.html($('script[type="text/html"][template="section"]').html());
                var key = $warp.find('[tpl-section=badge]')[0].id;
                var text = $warp.find('[tpl-section=text]')[0].textContent;
                var cache = localStorage.getItem(key);
                if (null != cache) {
                    text = cache;
                }
                this.parentNode.nextElementSibling.children[0].childNodes[3].value = $.trim(text);

            });
            $(document).on('click', '[tpl-section-save=btn]', function () {

                var key = this.closest('[tpl-section="warp"]').children[0].id + "";
                var value = "" + this.parentNode.previousElementSibling.value;
                value = $.trim(value);
                this.parentNode.previousElementSibling.value = value;
                var cache = localStorage.getItem(key);
                if (null != cache) {
                    localStorage.removeItem(key)
                }

                if (value != cache) {
                    localStorage.setItem(key, value);
                }
                $(this).closest('[tpl-section="warp"]').find('[tpl-section="box"]').html('');

                checkIfUpdate();
            });
            $(document).on('click', '[tpl-section-cancle=btn]', function () {
                var $warp = $(this).closest('[tpl-section="warp"]');
                $warp.find('[tpl-section="box"]').html('');
            });

        });
    })(Report, jQuery);
</script>
<!--句子分析模块，修改建议事件-->
<script type="text/javascript">
    (function (System, $) {
        var tab = System.Paper.tab();
        var $advice = null;

        function run() {
            var i = 0;
            $advice.show();
            tab.call(this, {
                callback: function () {
                    var $num = $(this).find('.chapter-num');
                    if ($num.length > 0) {
                        i++;
                        $num.text(i);
                    }
                }
            });
            //没有内容时同时不显示该句修改建议
            if (0 === i) {
                $advice.hide();
            }
        }

        $(function () {
            $advice = $('#advice');
            $(document).on('click', '[tab-a="ul"] li', function () {
                run.call(this);
            });
            $(document).on('click', '[tab-b="ul"] li', function () {
                run.call(this);
            });
        });
    })(Report, jQuery);
</script>

<!--综合评估模块，相似文档的详细内容展示或收起控件-->
<script type="text/javascript">
    (function (System, $) {
        $(function () {
            $(document).on('click', '[eve-toggle=btn]', function (event) {
                var $this = $(this);
                System.Paper.toggle.call(this, function () {
                    $this.find('[eve-toggle="text"]').text('收起');
                    $this.addClass('active');
                }, function () {
                    $this.find('[eve-toggle="text"]').text('详情');
                    $this.removeClass('active');

                });

            });

            $(document).on('click', '[eve-toggle-btn=close]', function (event) {
                var $this = $(this).closest('[eve-toggle=warp]').find('[eve-toggle=btn]');
                System.Paper.toggle.call(this, function () {
                    $this.addClass('active');
                }, function () {
                    $this.find('[eve-toggle="text"]').text('详情');
                    $this.removeClass('active');

                });

            });

        });
    })(Report, jQuery);
</script>
<!--修改页面模块，字体颜色更改事件-->
<script type="text/javascript" th:inline="javascript">
    $(function () {
        checkIfUpdate();
    });

    function checkIfUpdate() {
        var analysisList = [[${list}]]
        analysisList.forEach(function (analysis, index) {
            var key = (index + 1) + "";
            var value = localStorage.getItem(key);
            var id = '#' + (index + 1) + '-data';
            if (null != value && value != analysis.analysisName) {
                $(id).addClass('g-font-color green').html($.trim(value))
            }
            if (value == analysis.analysisName) {
                $(id).removeClass('g-font-color green').html($.trim(value))
            }
        });
    }


</script>

<!-- 日期格式化-->
<script type="text/javascript">
    Date.prototype.Format = function (fmt) { //author: meizz
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    }
</script>

<!-- 综合内容模块，动态获取数据-->
<script th:inline="javascript">
    $(document).ready(function () {
        var list;
        var content = "";
        var policy;
        $.ajax({
            url: "/review/getPolicySimilarity",
            type: "post",
            dataType: "json",
            async: false,
            data: {
                reviewId: [[${policy_review.reviewid}]]
            },
            success: function (response) {
                list = response;
            },
            error: function (response) {
                toastr.error("信息获取失败");
                return;
            }
        });
        list.forEach(function (policySimilarity) {
            var keyword = "";
            $.ajax({
                url: "/policy/getById",
                type: "post",
                dataType: "json",
                async: false,
                data: {
                    policyId: policySimilarity.similarityPolicyId
                },
                success: function (response) {
                    policy = response;
                },
                error: function (response) {
                    toastr.error("政策相似信息获取失败");
                    return;
                }
            });
            $.ajax({
                url: "/policyanalysis/getKeyWordByPolicyId",
                type: "post",
                dataType: "json",
                async: false,
                data: {
                    policyId: policySimilarity.similarityPolicyId
                },
                success: function (response) {
                    if (response.length > 0) {
                        response.forEach(function (Policy_analysis, index) {
                            if (index == 0) {
                                keyword = Policy_analysis.analysisName;
                            } else {
                                keyword += " " + Policy_analysis.analysisName;
                            }
                        });
                    } else {
                        keyword = "";
                    }
                },
                error: function (response) {
                    toastr.error("政策核心精神获取失败");
                    return;
                }
            });

            content += "<li eve-toggle=\"warp\">" +
                "<span class=\"g-font-color green percentage-span\">" + policySimilarity.similarityDegree + "%</span>" +
                "<span class=\"progress grey MLR10\">" +
                "<span class=\"progress-bar green\" style=\"width: " + policySimilarity.similarityDegree + "%;\"></span>" +
                "</span>" +
                "<div class=\"g-arrow inline-block hand MR20\" eve-toggle=\"btn\">" +
                "<span class=\"g-font-color green\" eve-toggle=\"text\">详情</span>" +
                "<i class=\"g-arrow-i\"></i>" +
                "</div>" +
                "<span class=\"MR5\">" +
                "<span class=\"font-bold paperSource\">来源：</span> 对比库 河北省地方税务局 " + new Date(policy.uploadDate).Format("yyyy-MM-dd") +
                "</span>" +
                "<span class=\"MR5\">" +
                "<span class=\"font-bold paperAuthor\">作者：</span> 张三" +
                "</span>" +
                "<span class=\"MR5\">" +
                "<span class=\"font-bold paperTitle\">篇名：</span> " + policy.policyName +
                "</span>" +
                "<div class=\"local-source-detail none\" eve-toggle=\"section\">" +
                "<div><b>标题：</b>" + policy.policyName + "<br><b>上传人员：</b> 张三" + "<br><b>核心精神：</b>" + keyword +
                "</div>" +
                "<div class=\"g-arrow inline-block hand\" eve-toggle-btn=\"close\">" +
                "" +
                "<span class=\"g-font-color green\">收起</span>" +
                "<i class=\"g-arrow-i\"></i>" +
                "</div>" +
                "</div>" +
                "</li>";
        })
        $("#getPolicySimilarity").html(content);
    });

</script>


<!-- 句子分析模块，动态获取数据-->
<script th:inline="javascript">
    function getByAnalysis(analysisId, analysisName, similarityDegree) {

        //接收获取的相似信息
        var list;
        $.ajax({
            url: "/review/getSimilarityByAnalysisId",
            type: "post",
            dataType: "json",
            async: false,
            data: {
                analysisId: analysisId
            },
            success: function (response) {
                list = response;
            },
            error: function (response) {
                toastr.error("信息获取失败");
                return;
            }
        });

        var content = "";
        content += "" +
            "<span id=\"gototop\"></span>" +
            "<div>" +
            "<div class=\"paper-txt P30\">" +
            "<div class=\"paper-section\" style=\"margin-bottom:0;\">" +
            "<div class=\"font-bold MT5\">" +
            "\t该句相似度：<span class=\"g-font-color red similarNum\">" + similarityDegree + "%</span>" +
            "</div>" +
            "<div class=\"MT30\">" +
            "<p class=\"font-bold\">您的语句：</p>" +
            "<span>" + analysisName + "</span>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "<div>" +
            "<div class=\"tab-A\">" +
            "<ul class=\"tab-A-ul clearfix unstyled\" tab-a=\"ul\">" +
            "<li class=\"active\" data-id=\"已审查内容,互联网,自建库,all\">" +
            "<span class=\"tab-text\">综合</span>" +
            "<span class=\"tab-superscript\">" + list.length + "</span>" +
            "</li>" +
            "<li data-id=\"tab,已审查内容,自建库,local\">" +
            "<span class=\"tab-text\">本地库</span>" +
            "<span class=\"tab-superscript\">" + list.length + "</span>" +
            "</li>" +
            "<li data-id=\"互联网,5\">" +
            "<span class=\"tab-text\">互联网</span>" +
            "<span class=\"tab-superscript\">0</span>" +
            "</li>" +
            "</ul>" +
            "</div>" +
            "<div class=\"none\" tab=\"section\" data-id=\"tab\">" +
            "<div class=\"tab-B clearfix\">" +
            "<div class=\"paper-section P30 PB0 clearfix\">" +
            "<span class=\"tab-B-span pull-left\">本地库</span>" +
            "<ul class=\"tab-B-ul pull-left clearfix unstyled\" tab-b=\"ul\">" +
            "<li class=\"active\" data-id=\"tab,已审查内容,自建库,local\">" +
            "<span class=\"tab-text\">全部</span>" +
            "<span class=\"tab-superscript\">" + list.length + "</span>" +
            "<span class=\"black-spacer\"></span>" +
            "</li>" +
            "<li data-id=\"tab,已审查内容,1\">" +
            "<span class=\"tab-text\">规范性文件</span>" +
            "<span class=\"tab-superscript\">0</span>" +
            "<span class=\"black-spacer\"></span>" +
            "</li>" +
            "<li data-id=\"tab,对比库,2\">" +
            "<span class=\"tab-text\">对比库</span>" +
            "<span class=\"tab-superscript\">" + list.length + "</span>" +
            "<!--<span class=\"black-spacer\"></span>-->" +
            "</li>" +
            "</ul>" +
            "</div>" +
            "<div class=\"g-line-row MT30 tab-pane-line\"></div>" +
            "</div>" +
            "</div>" +
            "<div class=\"content-tips\">" +
            "<div class=\"tab-content none\" tab=\"section\" data-id=\"1\">" +
            "<div class=\"paper-txt P30 paper-section clearfix\">" +
            "<p class=\"g-font-color green pull-left\">" +
            "\t在规范性文件库共找出相似内容：<span>0</span>个" +
            "<p>" +
            "<div class=\"pull-right\">" +
            "<a href=\"#modify_suggest\" class=\"g-btn g-btn-default g-btn-sm\">查看修改意见</a>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "<div class=\"tab-content none\" tab=\"section\" data-id=\"2\">" +
            "<div class=\"paper-txt P30 paper-section clearfix\">" +
            "<p class=\"g-font-color green pull-left\">" +
            "\t在对比库共找出相似内容：<span>" + list.length + "</span>个" +
            "<p>" +
            "<div class=\"pull-right\">" +
            "<a href=\"#modify_suggest\" class=\"g-btn g-btn-default g-btn-sm\">查看修改意见</a>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "" +
            "<div class=\"tab-content none\" tab=\"section\" data-id=\"5\">" +
            "<div class=\"paper-txt P30 paper-section clearfix\">" +
            "<p class=\"g-font-color green pull-left\">" +
            "\t在互联网库共找出相似内容：<span>0</span>个" +
            "<p>" +
            "<div class=\"pull-right\">" +
            "<a href=\"#modify_suggest\" class=\"g-btn g-btn-default g-btn-sm\">查看修改意见</a>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "<!-- 自建库 -->" +
            "<div class=\"tab-content none\" tab=\"section\" data-id=\"6\">" +
            "<div class=\"paper-txt P30 paper-section clearfix\">" +
            "<p class=\"g-font-color green pull-left\">" +
            "\t在自建库共找出相似内容：<span>" + list.length + "</span>个" +
            "<p>" +
            "<div class=\"pull-right\">" +
            "</div>" +
            "</div>" +
            "</div>" +
            "<div class=\"tab-content\" tab=\"section\" data-id=\"all\">" +
            "<div class=\"paper-txt P30 paper-section clearfix\">" +
            "<p class=\"g-font-color green pull-left\">" +
            "\t在本地库和互联网库共找出相似内容：<span>" + list.length + "</span>个" +
            "<p>" +
            "<div class=\"pull-right\">" +
            "<a href=\"#modify_suggest\" class=\"g-btn g-btn-default g-btn-sm\">查看修改意见</a>" +
            "" +
            "</div>" +
            "</div>" +
            "</div>" +
            "<div class=\"tab-content none\" tab=\"section\" data-id=\"local\">" +
            "<div class=\"paper-txt P30 paper-section clearfix\">" +
            "<p class=\"g-font-color green pull-left\">" +
            "\t在本地库共找出相似内容：<span>" + list.length + "</span>个" +
            "<p>" +
            "<div class=\"pull-right\">" +
            "<a href=\"#modify_suggest\" class=\"g-btn g-btn-default g-btn-sm\">查看修改意见</a>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "";
        list.forEach(function (policysimilarity, index) {

            var policyContent;
            var policyAnalysis;
            var policy;
            var policyKeyWord;
            $.ajax({
                url: "/policy/getContentById",
                type: "post",
                dataType: "json",
                async: false,
                data: {
                    contentId: policysimilarity.similarityContentId
                },
                success: function (response) {
                    policyContent = response;
                },
                error: function (response) {
                    toastr.error("段落信息获取失败");
                    return;
                }
            });

            $.ajax({
                url: "/policyanalysis/getAnalysisById",
                type: "post",
                dataType: "json",
                async: false,
                data: {
                    analysisId: policysimilarity.similarityAnalysisId
                },
                success: function (response) {
                    policyAnalysis = response;
                },
                error: function (response) {
                    toastr.error("句子信息获取失败");
                    return;
                }
            });

            $.ajax({
                url: "/policy/getById",
                type: "post",
                dataType: "json",
                async: false,
                data: {
                    policyId: policysimilarity.similarityPolicyId
                },
                success: function (response) {
                    policy = response;
                },
                error: function (response) {
                    toastr.error("政策信息获取失败");
                    return;
                }
            });
            $.ajax({
                url: "/policyanalysis/getKeyWordByPolicyId",
                type: "post",
                dataType: "json",
                async: false,
                data: {
                    policyId: policysimilarity.similarityPolicyId
                },
                success: function (response) {

                    response.forEach(function (policysimilarity, index) {
                        if (index == 0) {
                            policyKeyWord = policysimilarity.analysisName;
                        } else {
                            policyKeyWord += " " + policysimilarity.analysisName;
                        }
                    })
                },
                error: function (response) {
                    toastr.error("核心精神获取失败");
                    return;
                }
            });


            content += "<div class=\"tab-content\" tab=\"section\" data-id=\"2\">" +
                "<div>" +
                "<div class=\"g-line-row\"></div>" +
                "<div class=\"paper-txt P30\">" +
                "<div class=\"paper-section\" style=\"margin-bottom:0;\">" +
                "<div class=\"clearfix\">" +
                "<div class=\"pull-left\">" +
                "<span class=\"chapter-symbol\"></span>" +
                "<span class=\"chapter-num\">" + (index + 1) + "</span>" +
                "" +
                "</div>" +
                "<div class=\"font-bold pull-right\">" +
                "\t相似度：<span class=\"g-font-color red similarNum\">" + policysimilarity.similarityDegree + "%</span>" +
                "</div>" +
                "</div>" +
                "<div class=\"MT10\">" +
                "<p class=\"font-bold\">您的句子：</p>" +
                "<p class=\"g-font-color red\">" + analysisName +
                "</p>" +
                "" +
                "</div>" +
                "<div class=\"MT10\">" +
                "<p class=\"font-bold\">相似句子：</p>" +
                "<p class=\"g-font-color green\">" + policyAnalysis.analysisName +
                "</p>" +
                "</div>" +
                "<div class=\"MT10\">" +
                "<p class=\"font-bold\">相似原文片段：</p>" + policyContent.contentText +
                "</div>" +
                "<div class=\"MT10\">" +
                "<p class=\"font-bold\">来源（对比库）：</p>" +
                "<div class=\"local-source-detail\">" +
                "<b>篇名：</b>" + policy.policyName + "<br><b>上传者：</b>张三<br><b>作者单位：</b>河北省地方税务局<br><b>页数：</b>2页<br>上传时间：</b>" + new Date(policy.uploadDate).Format("yyyy-MM-dd") + "<br><b>关键词：</b>" +
                policyKeyWord +
                "</div>" +
                "</div>" +
                "</div>" +
                "</div>" +
                "" +
                "</div>" +
                "" +
                "</div>";
        });

        content +=
            "<!--语句修改建议-->" +
            "<span id=\"modify_suggest\"></span>" +
            "<div id=\"advice\">" +
            "<div class=\"g-line-row\"></div>" +
            "<div class=\"paper-txt P30 PB0\">" +
            "<div class=\"paper-section\">" +
            "<p class=\"g-font-s16 font-bold g-font-color green MB10\">" +
            "\t该句修改建议（重度相似，请全面修改）</p>" +
            "<span class=\"g-font-color green\"><span class=\"g-font-color red\">通过</span><span class=\"g-font-color red\">运行</span>程序来<span" +
            " class=\"g-font-color red\">检验</span>程序的<span class=\"g-font-color red\">动态</span><span class=\"g-font-color red\">行为</span>和<span" +
            " class=\"g-font-color red\">运行</span><span class=\"g-font-color red\">结果</span>的重要<span class=\"g-font-color red\">性</span>。</span>" +
            "<div class=\"MT10\">" +
            "<p class=\"font-bold\">同义词：</p>" +
            "<ul class=\"local-source-detail\">" +
            "<li class=\"g-font-color green\"><span class=\"g-font-color red\">运行：</span>运转" +
            "\t运作 周转" +
            "</li>" +
            "<li class=\"g-font-color green\"><span class=\"g-font-color red\">通过：</span>越过" +
            "\t穿过 穿越" +
            "</li>" +
            "<li class=\"g-font-color green\"><span class=\"g-font-color red\">检验：</span>查验" +
            "\t检修 检讨" +
            "</li>" +
            "<li class=\"g-font-color green\"><span class=\"g-font-color red\">结果：</span>成效" +
            "\t成果 成绩" +
            "</li>" +
            "</ul>" +
            "" +
            "</div>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "</div>" +
            "<div class=\"back-to-top text-center\">" +
            "<a href=\"#gototop\" class=\"font-bold g-font-color green\">回到顶部</a>" +
            "</div>" +
            "<div class=\"paper-footer\">" +
            "<p>检测报告由" +
            "<a href=\"http://www.paperpass.com/\" target=\"_black\">PRAS</a>规范性文件审查系统生成" +
            "</p>" +
            "<p>Copyright © 2018-2019 PRAS</p>" +
            "</div>" +
            "</div>";
        $("#getByAnalysisId").html(content);
    }


</script>
</body>

</html>